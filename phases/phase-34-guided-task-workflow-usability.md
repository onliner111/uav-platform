# Phase 34 - 任务流程向导化与可用性重构

## 0. Basis
- Based on: `项目最终目标.md`
- Depends on: `phases/phase-33-one-map-command-center-v2.md`

## 1. Objective
将复杂业务操作重构为向导式、低培训成本的流程体验，使非技术业务人员可独立完成核心任务。

## 2. Scope
- 巡检任务创建向导
- 应急任务快速建单向导
- 审批流可视化流程条与状态解释
- 任务异常、校验失败与纠错引导
- 模板预填、推荐项、默认值与风险提示

## 3. Out of Scope
- 移动端现场简化端（Phase 35）
- 外部通知协同产品化（Phase 37）

## 4. Deliverables
- 向导式任务创建与审批流页面
- 错误提示与纠错交互规范
- 模板推荐与预填策略
- 面向业务人员的任务流程演示脚本

## 5. Acceptance
- 巡检与应急任务可通过分步向导完成
- 关键流程错误可被业务人员理解和修正
- 核心流程从“会填字段”转为“会走业务步骤”

## 6. Product Delivery Standard
- 本阶段所有任务与审批相关 UI，必须以非技术业务人员可独立完成为标准，默认不暴露底层参数录入
- 本阶段必须继承并保持 Phase 32 已达成的产品化效果：中文化、对象选择驱动、统一壳层、统一组件、统一状态反馈、管理员能力下沉，不得因向导化重构而回退
- 主流程必须采用向导、对象选择、预填、校验提示和明确结果反馈，不得继续把手填 ID 或 JSON 作为主交互
- 文案、布局、按钮层级和异常提示必须与前序产品化页面保持统一，避免新旧两套体验并存
- 本阶段触达的遗留流程页必须全部改造完成后才能关账，不允许保留“暂时可用”的工程化页面
- 任何对既有任务、告警、合规、应急等页面的联动修改，都必须达到“不低于 Phase 32 当前完成效果”的标准，不能用新增向导覆盖旧问题但保留旧页面回退

## 7. Exit Criteria
- `ruff`, `mypy`, `pytest`, `e2e` 全绿
- 本阶段涉及的任务流程页面全部达到正式交付标准
- 本阶段触达的既有页面保持或优于 Phase 32 的产品化效果，不得出现交互、文案、导航或视觉回退
- 向导式流程演示脚本可复跑

---

## 8. Priority Tuning (P0/P1/P2)

- P0：
  - `34-WP1` 巡检任务向导
  - `34-WP2` 应急任务快速建单向导
- P1：
  - `34-WP3` 审批流可视化与流程条
  - `34-WP4` 校验失败与纠错引导
- P2：
  - `34-WP5` 模板推荐、预填与风险提示增强
- 执行顺序：`P0 -> P1 -> P2 -> 34-WP6`

## 9. Execution Progress

- [x] 34-WP1 巡检任务向导（已将巡检创建主路径重构为“选择模板 -> 填写信息 -> 确认创建”的三步向导）
- [x] 34-WP2 应急任务快速建单向导（已将应急处置主路径重构为“地图选点 -> 创建事件 -> 联动任务”的三步向导）
- [x] 34-WP3 审批流可视化（已在合规页补齐审批流程条与连续步骤提示）
- [x] 34-WP4 纠错引导与异常解释（已在巡检/应急向导中补齐就地纠错提示与下一步引导）
- [x] 34-WP5 模板推荐与预填增强（已补齐模板推荐、默认命名预填与风险等级提示）
- [x] 34-WP6 验收关账（已通过 `ruff`、`mypy`、全量 `pytest -q`、`up --build -d` 与 `demo_phase34_guided_task_workflow_usability.py`）
